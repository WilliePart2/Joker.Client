<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Joker client</title>
    <script type="text/javascript">
        /**
         * @type {{
         *      gamepath: string
         *      entrypoint: string
         *  }}
         */
        let params = {
            gamepath: '',
            entrypoint: ''
        };
        let gameKey = 'JOKER';

        parseQueryString(params);
        loadGame(params, () => runGame(gameKey));

        function parseQueryString (store) {
            let query = window.location.search.substr(1)
                .split('&');

            query.forEach((parameter) => {
                let parameterPear = parameter.split('='),
                    key = parameterPear[0].toLowerCase(),
                    value = parameterPear[1];

                if (value) {
                    store[key] = value;
                }
            });
        }

        function loadGame ({gamepath, entrypoint}, callback) {
            if (!gamepath) {
                throw new Error ('Game path empty!');
            }

            let script = document.createElement('script');
            script.addEventListener('load', () => {
                callback();
            }, false);
            script.src = createURL(`${gamepath}/${entrypoint}`);
            document.documentElement.appendChild(script);
        }

        function createURL (path) {
            let location = window.location,
                protocol = location.protocol,
                host = location.hostname,
                port = location.port,
                fullPath = `${protocol}//${host}:${port}/${path}`;

            console.log(`CREATED URL: ${fullPath}`);

            return fullPath;
        }

        function runGame (key) {
            let game = new window[key]();
        }
    </script>
</head>
<body>
<div id="gameContainer" style="height: 700px;"></div>
</body>
</html>